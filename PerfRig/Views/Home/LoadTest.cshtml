<script>
    var loadTestName = window.location.pathname.split('/')[3]
    document.write("<h1>" + decodeURIComponent(loadTestName) + "</h1>");
</script>
<br />
<h2>Web Tests:</h2>
<div id="nav" class="clearfix">
    <ul id="webtests" />
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
    <script>
        var nameUri = window.location.origin + '/api/loadtests/GetWebTests/' + loadTestName;

        $(document).ready(function () {
            //Send an AJAX request
            $.getJSON(nameUri)
                .done(function (data) {
                    //On success, 'data' contains a list of load tests.
                    $.each(data, function (key, item) {
                        //Add a list item for the load test.
                        $('#webtests').append("<li><a href='" + window.location.origin + "/Home/WebTest/" + loadTestName + "/" + item + "'>" + item + "</a></li>");
                    });
                });
        });
    </script>
</div>
<div id="content">
    <div id="visualization"></div>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
    <script>
        var container = document.getElementById('visualization');

        var timeUri = window.location.origin + '/api/loadtests/GetLoadTestTimes/' + loadTestName;

        $(document).ready(function () {
            $.getJSON(timeUri)
                .done(function (data) {
                    var items = [];
                    $.each(data, function (key, item) {
                        items.push({ id: item.Id, x: item.TimeStamp, y: item.ElapsedTime });
                    })

                    var dataset = new vis.DataSet(items);

                    function compare(a, b) {
                        if (a.TimeStamp < b.TimeStamp)
                            return -1;
                        if (a.TimeStamp > b.TimeStamp)
                            return 1;
                        return 0;
                    }

                    items.sort(compare);
                    var options = {
                        style: 'bar',
                        barChart: { width: 50, align: 'center', handleOverlap: 'sideBySide' }, // align: left, center, right
                        drawPoints: false,
                        dataAxis: {
                            icons: true
                        },
                        orientation: 'top',
                        start: items[0].TimeStamp,
                        end: items[items.length - 1].TimeStamp
                    };

                    var graph2d = new vis.Graph2d(container, items, options);
                })
        })
    </script>
</div>